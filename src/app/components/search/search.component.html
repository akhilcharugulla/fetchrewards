<div class="search-container">
  <!-- Main grid layout -->
  <div class="search-grid">
    <!-- Left Sidebar for Filters -->
    <div class="filters-sidebar" [ngClass]="{'collapsed': !showFilters}">
      <div class="filters-card">
        <div class="filters-header">
          <h3>Filters</h3>

        <!-- Left side - Filter toggle -->
        <div class="filter-toggle" (click)="toggleFilters()">
          <i class="pi pi-bars"></i>
        </div>
        </div>
        
        <div class="filters-content">
          <!-- Breeds Filter -->
          <div class="filter-group">
            <h4 class="filter-label">Breeds</h4>
            <p-multiSelect
              [options]="breeds"
              [(ngModel)]="selectedBreeds"
              [filter]="true"
              placeholder="Select Breeds"
              (onChange)="search()"
              styleClass="w-full"
            ></p-multiSelect>
          </div>
          
          <!-- Age Filter -->
          <div class="filter-group">
            <h4 class="filter-label">Age</h4>
            <p-dropdown
              [options]="ageOptions"
              [(ngModel)]="selectedAge"
              placeholder="Select Age"
              (onChange)="search()"
              styleClass="w-full"
            ></p-dropdown>
          </div>
          
          <!-- Zipcodes Filter -->
          <div class="filter-group">
            <h4 class="filter-label">Zipcodes</h4>
            <p-multiSelect
              [options]="zipCodes"
              [(ngModel)]="selectedCities"
              placeholder="Select Zipcode"
              (onChange)="search()"
              styleClass="w-full"
            ></p-multiSelect>
          </div>
          
          <!-- Cities Filter -->
          <div class="filter-group">
            <h4 class="filter-label">Cities</h4>
            <p-multiSelect
              [options]="locationOptions"
              [(ngModel)]="selectedCities"
              placeholder="Select City"
              (onChange)="search()"
              styleClass="w-full"
            ></p-multiSelect>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Area -->
    <div class="main-content" [ngClass]="{'full-width': !showFilters}">
      <!-- Control Bar -->
      <div class="control-bar">
        
        <!-- Right side - Sort and Find Match -->
        <div class="controls-right">
          <p-dropdown
            [options]="sortOptions"
            [(ngModel)]="sortField"
            placeholder="Sort By"
            (onChange)="onSortChange($event)"
            styleClass="sort-dropdown"
          ></p-dropdown>
          
          <p-button
            *ngIf="favorites.length > 0"
            label="Find Match"
            icon="pi pi-heart"
            (onClick)="findMatch()"
            styleClass="match-button"
          ></p-button>
        </div>
      </div>

      <!-- Dogs Grid -->
      <div class="dogs-grid">
        <div class="dog-card-wrapper" *ngFor="let dog of dogs">
          <app-dog-card
            [dog]="dog"
            [isFavorite]="isFavorite(dog)"
            [distance]="dog.distance"
            [location]="dogLocations.get(dog.zip_code)"
            (favoriteToggle)="toggleFavorite($event)"
          ></app-dog-card>
        </div>
      </div>

      <!-- Paginator -->
      <div class="pagination-container">
        <p-paginator
          [rows]="12"
          [totalRecords]="totalDogs"
          (onPageChange)="onPageChange($event)"
        ></p-paginator>
      </div>
    </div>
  </div>
</div>

<!-- Match Dialog -->
<p-dialog
  [(visible)]="showMatchDialog"
  header="Your Perfect Match!"
  [modal]="true"
  [style]="{width: '90vw', maxWidth: '500px'}"
>
  <div *ngIf="matchedDog" class="match-dialog-content">
    <app-dog-card
      [dog]="matchedDog"
      [isFavorite]="true"
      (favoriteToggle)="toggleFavorite($event)"
    ></app-dog-card>
  </div>
</p-dialog>