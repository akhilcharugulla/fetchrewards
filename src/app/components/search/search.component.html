<div class="container">
  <div class="grid">
    <!-- Left Sidebar for Filters -->
    <div class="col-12 md:col-3 sidebar" [class.collapsed]="!showFilters">
      <p-card styleClass="h-full">
        <div class="filter-header mb-3">
          <h3 class="m-0">Filters</h3>
        </div>
        <div class="filters-container">
          <div class="mb-3">
            <h4>Breeds</h4>
            <p-multiSelect
              [options]="breeds"
              [(ngModel)]="selectedBreeds"
              [filter]="true"
              placeholder="Select Breeds"
              (onChange)="search()"
              styleClass="w-full"
            ></p-multiSelect>
          </div>
          <div class="mb-3">
            <h4>Age</h4>
            <p-dropdown
              [options]="ageOptions"
              [(ngModel)]="selectedAge"
              placeholder="Select Age"
              (onChange)="search()"
              styleClass="w-full"
            ></p-dropdown>
          </div>
        </div>
      </p-card>
    </div>

    <!-- Main Content for Dog Cards -->
    <div class="col-12" [class.md:col-9]="showFilters" [class.md:col-12]="!showFilters">
      <!-- Filter Icon and Sort By in the Same Line -->
      <div class="mb-3 flex justify-content-between align-items-center">
        <!-- Filter Icon and Text (Left Side) -->
        <div class="flex align-items-center gap-2 filter-toggle" (click)="toggleFilters()">
          <i class="pi pi-bars filter-icon"></i>
          <span class="filter-text">
            {{ !showFilters ? 'Show Filters' : 'Hide Filters' }}
          </span>
        </div>

        <!-- Sort By and Find Match Button (Right Side) -->
        <div class="flex align-items-center gap-2">
          <p-dropdown
            [options]="sortOptions"
            [(ngModel)]="sortField"
            placeholder="Sort By"
            (onChange)="onSortChange($event)"
            styleClass="w-10rem"
          ></p-dropdown>
          <p-button
            *ngIf="favorites.length > 0"
            label="Find Match"
            icon="pi pi-heart"
            (onClick)="findMatch()"
          ></p-button>
        </div>
      </div>

      <!-- Dog Cards Grid -->
      <div class="grid">
        <div *ngFor="let dog of dogs" 
             class="col-12 md:col-6 lg:col-4 xl:col-3 mb-3">
          <app-dog-card
            [dog]="dog"
            [isFavorite]="isFavorite(dog)"
            (favoriteToggle)="toggleFavorite($event)"
          ></app-dog-card>
        </div>
      </div>

      <!-- Paginator -->
      <p-paginator
        [rows]="12"
        [totalRecords]="totalDogs"
        (onPageChange)="onPageChange($event)"
      ></p-paginator>
    </div>
  </div>
</div>

<!-- Match Dialog -->
<p-dialog
  [(visible)]="showMatchDialog"
  header="Your Perfect Match!"
  [modal]="true"
  [style]="{width: '90vw', maxWidth: '500px'}"
>
  <div *ngIf="matchedDog" class="text-center">
    <app-dog-card
      [dog]="matchedDog"
      [isFavorite]="true"
      (favoriteToggle)="toggleFavorite($event)"
    ></app-dog-card>
  </div>
</p-dialog>